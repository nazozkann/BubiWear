<%- include('../../shared/includes/head', { pageTitle: 'Your Cart' }) %>
<link rel="stylesheet" href="/styles/cart.css">
<script src="/javascript/cart-management.js" defer></script>
</head>
<body>
    <%- include('../../shared/includes/header') %>
    <main class="cart-layout">
        <div class="cart-area" id="cart-area">
            <h1>Cart</h1>
            <% if (locals.cart.items.length > 0) { %>
                <% locals.cart.items.forEach(item => { %>
                    <div class="cart-item">
                        <div class="item-info">
                            <div class="item-details">
                                <h4><%= item.product.title %></h4>
                                <p><%= item.product.price %>₺</p>
                            </div>
                            <div class="item-details-2">
                                <p>Quantity: <%= item.quantity %></p>
                                <button class="cancel-btn" data-product-id="<%= item.product.id %>" 
                                    data-csrf="<%= csrfToken %>">×</button>
                            </div>
                        </div>
                    </div>
                <% }) %>
                <div class="lower-info-total">
                    <hr>
                    <div class="total-info">
                        <p>Total</p>
                        <p><%= locals.cart.totalPrice.toFixed(2) %>₺</p>
                    </div>
                </div>
                <div class="pay-btn">
                    <form action="/orders" method="POST">
                        <input type="hidden" name="_csrf" value="<%= locals.csrfToken %>">
                        <button class="btn btn-dark">Proceed to Checkout</button>
                    </form>
                </div>
            <% } else { %>
                <p id="your-empty-cart">Your cart is empty.</p>
            <% } %>
        </div>
    </main>
    <%- include('../../shared/includes/footer') %>